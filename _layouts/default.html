<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% if page.title %}{{ page.title }} · {% endif %}{{ site.name }} — {{ site.description }}</title>
    {% include meta.html %}
    <link rel="stylesheet" type="text/css" href="{{ site.baseurl }}/style.css" />
    <link rel="alternate" type="application/rss+xml" title="{{ site.name }} — {{ site.description }}" href="{{ site.baseurl }}/feed.xml" />
  </head>
  <body class="site-body is-locked">
    <div class="access-screen" data-access-screen aria-live="polite">
      <div class="access-box">
        <h1 class="access-title">Access required</h1>
        <p class="access-copy">This notebook is for collaborators. Enter the password to continue.</p>
        <form class="access-form" data-access-form>
          <label class="access-label" for="access-password">Password</label>
          <input
            id="access-password"
            class="access-input"
            type="password"
            name="password"
            autocomplete="current-password"
            data-access-input
          />
          <button type="submit" class="link-button access-button">Unlock</button>
          <p class="access-error" data-access-error aria-live="assertive"></p>
        </form>
      </div>
    </div>
    <a class="skip-link" href="#main-content">Skip to content</a>
    <div class="site-wrapper">
      <header class="site-header">
        <div class="site-inner">
          <div class="site-brand">
            <a class="site-title" href="{{ site.baseurl }}/">{{ site.name }}</a>
            <p class="site-tagline">{{ site.description }}</p>
          </div>
          <nav class="site-nav" aria-label="Primary">
            <a href="{{ site.baseurl }}/">Writing</a>
            <a href="{{ site.baseurl }}/about">About</a>
            <a href="{{ site.baseurl }}/readinglist">Reading List</a>
            <a href="{{ site.baseurl }}/requests">Requests</a>
          </nav>
        </div>
      </header>
      <main id="main-content" class="site-main site-inner">
        {{ content }}
      </main>
      <footer class="site-footer">
        <div class="site-inner">
          <p>&copy; {{ site.time | date: "%Y" }} {{ site.name }}.</p>
          <ul class="site-links">
            {% assign socials = site.footer-links %}
            {% if socials.email %}
            <li><a href="mailto:{{ socials.email }}">Email</a></li>
            {% endif %}
            {% if socials.github %}
            <li><a href="https://github.com/{{ socials.github }}" rel="noopener">GitHub</a></li>
            {% endif %}
            {% if socials.twitter %}
            <li><a href="https://twitter.com/{{ socials.twitter }}" rel="noopener">Twitter</a></li>
            {% endif %}
            {% if socials.linkedin %}
            <li><a href="https://www.linkedin.com/in/{{ socials.linkedin }}" rel="noopener">LinkedIn</a></li>
            {% endif %}
            {% if socials.rss %}
            <li><a href="{{ site.baseurl }}/feed.xml">RSS</a></li>
            {% endif %}
          </ul>
        </div>
      </footer>
    </div>
    <script>
      (function () {
        const PASSWORD = "emerg3nce";
        const storageKey = "site-access";
        const body = document.body;
        const gate = document.querySelector("[data-access-screen]");
        const form = document.querySelector("[data-access-form]");
        const input = document.querySelector("[data-access-input]");
        const error = document.querySelector("[data-access-error]");

        function unlock() {
          body.classList.remove("is-locked");
          if (gate) {
            gate.style.display = "none";
          }
        }

        try {
          if (localStorage.getItem(storageKey) === "granted") {
            unlock();
            return;
          }
        } catch (e) {
          // localStorage unavailable; continue with manual check.
        }

        if (!form || !input) {
          return;
        }

        form.addEventListener("submit", function (event) {
          event.preventDefault();
          const value = (input.value || "").trim();
          if (value === PASSWORD) {
            try {
              localStorage.setItem(storageKey, "granted");
            } catch (e) {
              // ignore storage errors
            }
            unlock();
          } else if (error) {
            error.textContent = "Incorrect password. Please try again.";
          }
        });
      })();
    </script>
    {% include analytics.html %}
  </body>
</html>
